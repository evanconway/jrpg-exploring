17th of November, 2024

Our first goal is to get the minimum features that a jrpg has. Which IMO is a top down world with a character you can move around, and the ability to start a battle sequence. We got a lot of experience changing game states with our point and click adventures. I'm confident I can copy the same system and apply it here. I wonder if it might be best to always require a specific updateable? Like the over world doesn't work unless you're updating the overworld updateable. We'll have to see how we want to handle things like drawing overworld assets while other logic is going on. 

Let's just get the camera setup, and a square we can move around with the arrow keys.

We've gotten the structure for a basic world, and a way to switch to a different updateable. Even though we could probably just start hacking away, we should probably think through the logic for how a battle will actually work. In most games I've played, battles are always turn based. And you're almost always either choosing an option for your turn, or waiting for some sort of attack animation to complete. That animation could be from you or your opponent. There are also messages to the player indicating what's about to happen or what did happen. None of these things seem to tricky to code on their own.

As I type this out, what feels the most complicated is determining what moments will happen in the battle after the player makes their selection. If it was truly just turn based then I'd be less concerned. We have the player make their decision, player whatever sequence they chose, then play whatever sequence we have the enemy choose. I'm not exactly sure how the actual battle data will be effected by this, but hopefully we can put that off for now. What I am concerned by is a more complex system. Imagine something like multiple party members, and multiple enemies. What if certain players had a speed attribute that let them take turns more frequently. How do we determine the order all things occur?

Actually I think it's worth thinking through battles on paper first, as if it was a card game. Then we make the animations based on how the paper battle works. Essentially we could look at battles as a turn based game, but the computer can run each turn instantly (from a numan perspective). So the only thing slowing down the battles is waiting for the human player to pick their turn.

Though, truly, the only thing that's actually kind of tricky here is deciding who gets to go when there are multiple players, (npc or otherwise), and figuring out how that's determined. We could do something like Chrono Trigger where there's a meter that fills up over time, and when a players meter is full they can take their turn. That elegantly accounts for the idea of varying speed between players. We also could do that same logic, but not display it visually like chrono trigger does.

We could still do a simple turned based system. In something like Earthbound, all player characters take their turn at the same time. Perhaps we could store up actions and decide what order they occur in based on enemy choices. Or maybe just keep it ultra simple and let all player choices occur in order, then have all enemy choices occur in order.

Regardless of what we choose, I think I've established something: we should keep a queue of actions to be processed. After each action is processed, we could determine if it's time to request player input or not. We could use either simple turn based or the speed system I mentioned earlier. Actually if it's turn based, we could just wait for the queue to be empty then just get all the next actions from the players and npcs. 

So maybe we should create a system that processes actions next, and worry about the turn structure later. This also brings me to consider some sort of event system. When making other games I often caught myself wishing I could just "trigger" specific moments, and always had to rig up some sort of hack to make them work which I later ripped out. Perhaps this could be our chance to build that system. I'm thinking something where events are an enum, but can be entered during game via a console to trigger them. That'll be our next thing to think about.

18th of November, 2024

I just realized this console idea may not work well without more infrastructure. I added a basic thing to detect key inputs but it doesn't block input checking for the rest of the app.

For now, we just won't have game inputs. We'll work with this console system to work out system kinks. I'm not worried about just hacking in some sort of input system later.

We started the transition for a battle, and realized we may need a system that can accomodate lots of different starting animations. As for the battles themselves. We'll definitely at least need the option for different backgrounds. We'll spend some time thinking about this later.

19th of November, 2024

We could try and create a number of console triggered actions for slide-show battles. Like Player Attack and Enemy Attack or something.

When I made the battle_start script I was worried because that one script isn't going to work for all the different kinds of battles. We'll need different things for backgrounds, start animations, that sort of thing. But it did occur to me that we could add a massive option object as the single argument for the battle_start script. Then allow for arguments in our console commands.

For some reason I'm mentally stuck on all the transition aspects of a slide-show battle. I'll probably want some sort of animation on the over-world that ultimately fades to black. Do I want some sort of animation for the enemy and player "appearing" in the battle? Similar to how pokemon has the enemy slide into frame from off screen. I think some Final Fantasy games have the enemies appear 1 by 1 at the start. How would I handle wanting different kinds of intro animations like this? I wonder if we need to make assets in the battle similar to world objects in that we can set their position and sprite via an updateable. I suppose we could write functions for different kinds of animation starts, give them names, and let that be a parameter in our console function.

Though, honestly, as I write this out, I'm being more confident that we can figure out all this stuff later. I'm pretty sure I'm just going to have a simple animation to start the fight, fade to black, then fade back with any enemies already in-frame. I think if we want something more complicated we can just add it in later.

So maybe next we should focus on how to store and manipulate stats like health, mana, or whatever. Because we'll definitely need that regardless of everything else.

Ah, one thing I do think we'll want is the ability to add enemies mid-fight. And of course we'll want to be able to remove enemies mid-fight. So maybe we should focus next on creating actions wich add, and remove enemies, and add the concept of health and the ability to change it. 

Now I'm stuck on how enemy position works on screen. Maybe we shouldn't worry about this yet, but it will come up later. To clarify, if a battle started with 1 enemy I'd want it to start center screen. If it started with 2 enemies I'd want it to start with them side-by-side and neither in the center. But if the battle started with 1 enemey in the center, but later another entered the battle, I'd want it to be to the side of the center enemy and the original enemy does not change position. This is basically how Earthbound works. And it wouldn't be hard to do this, but honestly I'm not sure if that's the behavior I'll ultimately want. So perhaps for now we'll just hack a crappy position system in and not worry about it. We'll change it later. 

I've changed my mind, I want to update the battle script right now. I want to be able to write custom start animations. We'll just have a default one for now. Note we may also need to make custom outro and victory animations. 

I was moving things around and noticed that I can change what function the update function of a struct is inside that very update function. We'll have to remember this as a possible way to organize logic. It might be better than using our steps[step] system.

Last thought for today. A battle is ultimately just numbers in an invisible spreadsheet changing while fun animations play. But I wonder should we have animations play in response to numbers changing, or should we trigger animations which themselves change the numbers? Something to think about until we come back to this.


23rd of November, 2024

I'm tempted to let animations trigger game value changes. There are a couple reasons for this. First, I think it'll be the easiest way. Second, I want potentially visible game values to change in time with the animations. And if we have animations occur in response to value changes, I have to figure out some sort of complex system where the UI shows the original value until certain moments in the animation. And third, if I decide to involve any sort of real time elements, like Earthbounds ticking down health system, then animations make more sense for that.

I'm going to try and put it a different way. In an action game we would have attack animations with hitboxes and hurtboxes moving around at different times to determine when game values changed. I think we can claim these slide-show battles are the same thing, it's just there are no hit or hurtboxes. We can very much think of them as attack animations that trigger value updates.

Next I think we should try and make console events for altering game values. This does bring up some questions. For example, should events happen immediately? Maybe some should happen immediately and others should get handled later. Also we don't have any character entities like players or enemies yet. Also how should we handle character deaths in this game? My gut says they should be like state-based-actions in MTG, where after an animation/action is complete the battle checks the game state and triggers its own animations. (Maybe we should call animations something other than animations since they do so much more than just show pretty pictures on the screen.) Actually, that's exactly how we should handle that. We'll store animations in a queue, and between processing each animation we'll check the state of the battle to determine what happens next. We could actually think of the player turn as an animation itself which simply gets put on in the queue. Though we'll have to play around with that.

Well regardless of all this, we definitely need the ability to have characters in the battle, and for them to be defeated. Otherwise all the other factors like changing health, mana, or whatever aren't going to be testable. We should make console commands for adding characters to a battle. I think this data could be stored in the battle itself rather than globally, except for player health. Actually, yes, I'd like our next feature to be the ability to add and remove enemy characters from a battle.

For positioning enemies, we may want to insist on a middle-center origin always.

I've noticed something while working on this. I want to change how battles start so that I can instantly start a battle from the console. I don't want to wait through the intro animation each time. But this does mean that we'll have to change how the intro animations work so that we can still draw the battle while also executing the intro animation. This is kind of weird because the intro animation will need access to the battle itself so it can decide when to draw the battle. 

To clarify the above, I'm specifically interested in the black fade outs. I don't want the battle to have a fade from black built into it. I think the intro animation should handle this. But of course if the intro animation is the current updateable, it needs access to the battle and its draw function so it can handle doing the fade from black.

But I just realized something, intro animation already have access to the battle so they can set the global.updateable when they're done. So we should be able to just move things around. Let's try that. 

Another thing I noticed, I want my console to be more modern. I don't like having to fully type these commands each time. I want to be able to tab auto complete text. I bet we can start hacking something in to fix this.

We were able to update our console to be more useable. The only thing missing now is arguments. As a next goal let's add some sort of message display system to battles. After that we can assess and probably start adding a basic attack.
